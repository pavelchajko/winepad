{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\pavel.gichevski\\\\Desktop\\\\workspace\\\\React\\\\winepad\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\pavel.gichevski\\\\Desktop\\\\workspace\\\\React\\\\winepad\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\pavel.gichevski\\\\Desktop\\\\workspace\\\\React\\\\winepad\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\pavel.gichevski\\\\Desktop\\\\workspace\\\\React\\\\winepad\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\pavel.gichevski\\\\Desktop\\\\workspace\\\\React\\\\winepad\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\pavel.gichevski\\\\Desktop\\\\workspace\\\\React\\\\winepad\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\pavel.gichevski\\\\Desktop\\\\workspace\\\\React\\\\winepad\\\\src\\\\components\\\\Excel.js\";\nimport React from 'react';\n\nvar Excel =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Excel, _React$Component);\n\n  function Excel() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Excel);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Excel)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this._preSearchData = null;\n    _this.state = {\n      data: _this.props.initialData,\n      sortby: null,\n      descending: false,\n      edit: null,\n      search: false\n    };\n\n    _this.getInitialState = function () {\n      return {\n        data: _this.props.initialData,\n        sortby: null,\n        descending: false,\n        edit: null\n      };\n    };\n\n    _this._sort = function (ev) {\n      var cell = ev.target.cellIndex;\n\n      var sortedData = _this.state.data.slice();\n\n      var descending = _this.state.sortby === cell && !_this.state.descending;\n      sortedData.sort(function (a, b) {\n        return descending ? a[cell] < b[cell] ? 1 : -1 : a[cell] > b[cell] ? 1 : -1;\n      });\n\n      _this.setState({\n        data: sortedData,\n        sortby: cell,\n        descending: descending\n      });\n    };\n\n    _this._showEditor = function (e) {\n      _this.setState({\n        edit: {\n          row: parseInt(e.target.dataset.row, 10),\n          cell: e.target.cellIndex\n        }\n      });\n    };\n\n    _this._save = function (e) {\n      e.preventDefault();\n      var input = e.target.firstChild;\n\n      var data = _this.state.data.slice();\n\n      data[_this.state.edit.row][_this.state.edit.cell] = input.value;\n\n      _this.setState({\n        edit: null,\n        data: data\n      });\n    };\n\n    _this._toggleSearch = function () {\n      if (_this.state.search) {\n        _this.setState({\n          data: _this._preSearchData,\n          search: false\n        });\n\n        _this._preSearchData = null;\n      } else {\n        _this._preSearchData = _this.state.data;\n\n        _this.setState({\n          search: true\n        });\n      }\n    };\n\n    _this._search = function (ev) {\n      var needle = ev.target.value;\n\n      if (!needle) {\n        needle = needle.toLowerCase();\n\n        _this.setState({\n          data: _this._preSearchData\n        });\n\n        return;\n      }\n\n      var idx = ev.target.dataset.idx;\n\n      var searchData = _this._preSearchData.filter(function (row) {\n        return row[idx].toString().toLowerCase().indexOf(needle) > -1;\n      });\n\n      _this.setState({\n        data: searchData\n      });\n    };\n\n    _this._download = function (format, ev) {\n      var contents = format === 'json' ? JSON.stringify(_this.state.data) : _this.state.data.reduce(function (result, row) {\n        return result + row.reduce(function (rowresult, cell, idx) {\n          return rowresult + '\"' + cell.replace(/\"/g, '\"\"') + '\"' + (idx < row.length - 1 ? ',' : '');\n        });\n      });\n      var URL = window.URL || window.webkitURL;\n      var blob = new Blob([contents], {\n        type: 'text/' + format\n      });\n      ev.target.href = URL.createObjectURL(blob);\n      ev.target.download = 'data.' + format;\n    };\n\n    _this._renderSearch = function () {\n      if (_this.state.search === false) {\n        return null;\n      }\n\n      return React.createElement(\"tr\", {\n        onChange: _this._search,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, _this.props.headers.map(function (_ignore, idx) {\n        return React.createElement(\"td\", {\n          key: idx,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          type: \"index\",\n          \"data-idx\": idx,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }));\n      }));\n    };\n\n    _this._renderTable = function () {\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, \"Excel App\"), React.createElement(\"table\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        onClick: _this._sort,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, _this.props.headers.map(function (title, idx) {\n        if (_this.state.sortby === idx) {\n          title += _this.state.descending ? \" \\u2191\" : \" \\u2193\";\n        }\n\n        return React.createElement(\"th\", {\n          key: idx,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, title);\n      }))), React.createElement(\"tbody\", {\n        onDoubleClick: _this._showEditor,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, _this._renderSearch(), _this.state.data.map(function (row, rowidx) {\n        return React.createElement(\"tr\", {\n          key: rowidx,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, row.map(function (cell, idx) {\n          var content = cell;\n          var edit = _this.state.edit;\n\n          if (edit && edit.row === rowidx && edit.cell === idx) {\n            content = React.createElement(\"form\", {\n              onSubmit: _this._save,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 160\n              },\n              __self: this\n            }, React.createElement(\"input\", {\n              type: \"text\",\n              defaultValue: content,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 161\n              },\n              __self: this\n            }));\n          }\n\n          return React.createElement(\"td\", {\n            key: idx,\n            \"data-row\": rowidx,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 164\n            },\n            __self: this\n          }, content);\n        }));\n      }))));\n    };\n\n    _this._renderToolbar = function () {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"toolbar\",\n        id: \"searchButton\",\n        onClick: _this._toggleSearch,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, \"Search\"), React.createElement(\"button\", {\n        id: \"exportButton\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        href: \"data.json\",\n        onClick: _this._download.bind(_assertThisInitialized(_assertThisInitialized(_this)), 'json'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, \"Export JSON\")), React.createElement(\"button\", {\n        id: \"downloadButton\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        href: \"data.csv\",\n        onClick: _this._download.bind(_assertThisInitialized(_assertThisInitialized(_this)), 'csv'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, \"Download\")));\n    };\n\n    return _this;\n  }\n\n  _createClass(Excel, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"Excel\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, this._renderToolbar(), this._renderTable());\n    }\n  }]);\n\n  return Excel;\n}(React.Component);\n\nexport default Excel;","map":{"version":3,"sources":["C:\\Users\\pavel.gichevski\\Desktop\\workspace\\React\\winepad\\src\\components\\Excel.js"],"names":["React","Excel","_preSearchData","state","data","props","initialData","sortby","descending","edit","search","getInitialState","_sort","ev","cell","target","cellIndex","sortedData","slice","sort","a","b","setState","_showEditor","e","row","parseInt","dataset","_save","preventDefault","input","firstChild","value","_toggleSearch","_search","needle","toLowerCase","idx","searchData","filter","toString","indexOf","_download","format","contents","JSON","stringify","reduce","result","rowresult","replace","length","URL","window","webkitURL","blob","Blob","type","href","createObjectURL","download","_renderSearch","headers","map","_ignore","_renderTable","title","rowidx","content","_renderToolbar","bind","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\n\r\nclass Excel extends React.Component {\r\n    _preSearchData = null;\r\n\r\n    state = {\r\n        data:this.props.initialData,\r\n        sortby:null,\r\n        descending:false,\r\n        edit:null,\r\n        search:false\r\n    };\r\n\r\n    \r\n\r\n    getInitialState = ()=>{\r\n      return {\r\n        data:this.props.initialData,\r\n        sortby:null,\r\n        descending:false,\r\n        edit:null\r\n      };\r\n    }\r\n\r\n    _sort=(ev)=>{\r\n\r\n          var cell = ev.target.cellIndex;\r\n          var sortedData = this.state.data.slice();\r\n          var descending = this.state.sortby === cell && !this.state.descending;\r\n          sortedData.sort(function(a,b){\r\n            return descending ? (a[cell] < b[cell] ? 1 : -1) : (a[cell] > b[cell] ? 1 : -1);\r\n          });\r\n\r\n      \r\n          this.setState({\r\n            data:sortedData,\r\n            sortby:cell,\r\n            descending:descending\r\n          });\r\n    }\r\n\r\n    _showEditor = (e) =>{\r\n      this.setState({\r\n        edit:{\r\n          row:parseInt(e.target.dataset.row,10),\r\n          cell:e.target.cellIndex\r\n        }\r\n      })\r\n    }\r\n\r\n    _save = (e) =>{\r\n      e.preventDefault();\r\n      var input = e.target.firstChild;\r\n      var data = this.state.data.slice();\r\n      data[this.state.edit.row][this.state.edit.cell] = input.value;\r\n\r\n      this.setState({\r\n        edit:null,\r\n        data:data\r\n      })\r\n    }\r\n\r\n    _toggleSearch = ()=>{\r\n      if(this.state.search){\r\n        this.setState({\r\n          data:this._preSearchData,\r\n          search:false\r\n        });\r\n        this._preSearchData=null;\r\n      }else{\r\n        this._preSearchData=this.state.data;\r\n        this.setState({\r\n          search:true\r\n        });\r\n      }\r\n\r\n            \r\n    }\r\n\r\n    _search = (ev) =>{\r\n      var needle = ev.target.value;\r\n      \r\n      if(!needle){\r\n        needle = needle.toLowerCase();\r\n        this.setState({\r\n          data:this._preSearchData\r\n        });\r\n        return;\r\n      }\r\n     var idx = ev.target.dataset.idx;\r\n     var searchData = this._preSearchData.filter((row)=>{\r\n       return row[idx].toString().toLowerCase().indexOf(needle) > -1;\r\n     });\r\n     this.setState({\r\n       data:searchData\r\n     });\r\n    }\r\n\r\n    _download = (format, ev)=>{\r\n      var contents = format ==='json' ? JSON.stringify(this.state.data) \r\n      : this.state.data.reduce((result,row)=>{\r\n        return result + \r\n                row.reduce((rowresult,cell,idx)=>{\r\n                  return rowresult + '\"' + cell.replace(/\"/g, '\"\"') + '\"' + (idx <row.length -1 ? ',': '')\r\n                });\r\n      });\r\n\r\n      var URL = window.URL || window.webkitURL;\r\n      var blob = new Blob ([contents], {type:'text/'+format});\r\n      ev.target.href = URL.createObjectURL(blob);\r\n      ev.target.download = 'data.' + format;\r\n\r\n    }\r\n\r\n    _renderSearch = ()=>{\r\n      if(this.state.search === false){\r\n        return null;\r\n      }\r\n      return(\r\n          <tr onChange = {this._search}>\r\n            {\r\n                this.props.headers.map((_ignore,idx)=>{\r\n                return (\r\n                <td key = {idx}>\r\n                  <input type=\"index\" data-idx={idx}></input>\r\n                </td>\r\n                )\r\n              })\r\n            }\r\n          </tr>\r\n        )\r\n      \r\n    }\r\n\r\n    _renderTable = ()=>{\r\n      return (\r\n        <div className=\"App\">\r\n        <h1>Excel App</h1>\r\n        <table>\r\n        <thead  onClick={this._sort}>\r\n            <tr>{this.props.headers.map((title,idx)=>{\r\n              if(this.state.sortby === idx){\r\n                title += this.state.descending ? ' \\u2191' : ' \\u2193'\r\n              }\r\n                return <th key={idx} >{title}</th>\r\n            })}\r\n            </tr>\r\n        </thead>\r\n          <tbody onDoubleClick={this._showEditor}>\r\n          {\r\n            this._renderSearch()}\r\n            {this.state.data.map((row,rowidx)=>{\r\n              return(\r\n                      <tr key={rowidx}>\r\n                        {\r\n                          row.map((cell,idx)=>{\r\n                            var content = cell;\r\n                            var edit = this.state.edit;\r\n                            if(edit && edit.row === rowidx && edit.cell ===idx){\r\n                              content = <form onSubmit={this._save}>\r\n                                          <input type=\"text\" defaultValue={content}></input>\r\n                                        </form>;\r\n                            }\r\n                          return  <td key={idx} data-row={rowidx}>{content}</td>\r\n                                })\r\n                        }\r\n                      </tr>\r\n              )\r\n            })\r\n          }\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n      );\r\n    }\r\n\r\n    _renderToolbar = ()=>{\r\n      return (\r\n        <div>\r\n          <button className=\"toolbar\" id = \"searchButton\" onClick = {this._toggleSearch}>Search</button>\r\n          <button id = \"exportButton\"><a href = \"data.json\" onClick = {this._download.bind(this,'json')}>Export JSON</a></button>\r\n          <button id=\"downloadButton\"><a href = \"data.csv\" onClick = {this._download.bind(this,'csv')}>Download</a></button>\r\n        </div>\r\n      )\r\n    }\r\n\r\n  render() {\r\n    return (<div className=\"Excel\">\r\n        {this._renderToolbar()}\r\n        {this._renderTable()}\r\n        </div>\r\n    );\r\n\r\n\r\n  }\r\n}\r\n\r\nexport default Excel"]},"metadata":{},"sourceType":"module"}